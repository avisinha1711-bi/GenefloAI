<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenefloAI Genetic Translator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --accent: #06b6d4;
            --bg-dark: #0a0f1a;
            --bg-card: #1a2235;
            --text-light: #f8fafc;
            --text-lighter: #cbd5e1;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: #2d3748;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Network lines background - Increased visibility */
        .network-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.08;
        }
        
        .network-dot {
            position: absolute;
            width: 3px;
            height: 3px;
            background: white;
            border-radius: 50%;
        }
        
        .network-line {
            position: absolute;
            background: white;
            height: 1px;
            transform-origin: left center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            padding: 40px 0 30px;
            color: white;
            position: relative;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 12px;
            color: var(--text-light);
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            color: var(--text-muted);
            font-weight: 400;
        }
        
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
        }
        
        .input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        label {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-lighter);
            font-size: 1.1rem;
        }
        
        .sequence-counter {
            background: rgba(37, 99, 235, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--primary-light);
            font-weight: 500;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        input {
            flex: 1;
            padding: 16px 20px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--text-light);
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .input-actions {
            display: flex;
            gap: 12px;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        button.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-lighter);
        }
        
        button.secondary:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-light);
        }
        
        .complementary-preview {
            background: rgba(26, 34, 53, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid var(--primary);
            display: none;
            animation: fadeIn 0.5s ease;
            position: relative;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .complementary-preview.show {
            display: block;
        }
        
        .complementary-preview-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .complementary-preview-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            border: 1px solid var(--border);
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .result-box {
            background: rgba(26, 34, 53, 0.7);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
        }
        
        .result-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .result-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .result-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 18px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            min-height: 60px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border);
        }
        
        .visualization {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            position: relative;
        }
        
        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1;
        }
        
        .step-icon {
            width: 60px;
            height: 60px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.5rem;
            color: var(--primary);
            border: 1px solid var(--border);
        }
        
        .step-label {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .dna-strand {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            min-height: 150px;
            justify-content: center;
        }
        
        .base {
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            font-weight: 600;
            color: white;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .base:hover {
            transform: scale(1.05);
        }
        
        .a { background: #ef4444; }
        .t { background: #10b981; }
        .c { background: #f59e0b; color: #1e293b; }
        .g { background: #3b82f6; }
        .u { background: #8b5cf6; }
        
        .bond {
            width: 2px;
            height: 18px;
            background: var(--primary);
            opacity: 0.4;
        }
        
        .arrow {
            font-size: 1.5rem;
            color: var(--primary);
            margin: 0 15px;
            opacity: 0.7;
        }
        
        .protein-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-muted);
            background: rgba(37, 99, 235, 0.1);
            padding: 5px 10px;
            border-radius: 10px;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .info-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .info-card h3 {
            color: var(--text-lighter);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }
        
        .info-card ul {
            list-style: none;
        }
        
        .info-card li {
            margin-bottom: 12px;
            padding-left: 30px;
            position: relative;
            color: var(--text-muted);
        }
        
        .info-card li:before {
            content: "•";
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            left: 15px;
            font-size: 1.2rem;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            color: var(--text-muted);
            padding: 30px;
            opacity: 0.8;
            border-top: 1px solid var(--border);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            .input-actions {
                width: 100%;
            }
            
            .input-actions button {
                flex: 1;
            }
            
            .visualization {
                flex-direction: column;
                gap: 30px;
                padding: 20px;
            }
            
            .arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .process-step {
                width: 100%;
            }
            
            .dna-strand {
                flex-direction: row;
                min-height: auto;
                gap: 10px;
            }
            
            .bond {
                width: 15px;
                height: 2px;
            }
        }
        
        .highlight {
            background: rgba(245, 158, 11, 0.1);
            padding: 3px 6px;
            border-radius: 4px;
            color: #f59e0b;
        }
        
        .stop-codon {
            background: #ef4444;
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .start-codon {
            background: #10b981;
            padding: 3px 6px;
            border-radius: 4px;
            color: white;
        }
        
        .molecular-weight {
            margin-top: 15px;
            padding: 12px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 8px;
            font-weight: 600;
            color: var(--text-lighter);
            border-left: 3px solid var(--primary);
        }
        
        .placeholder {
            color: var(--text-muted);
            font-style: italic;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(150%);
            transition: transform 0.4s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--error);
        }
        
        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* New styles for strand selection */
        .strand-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .strand-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .strand-option {
            flex: 1;
            min-width: 200px;
        }
        
        .strand-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-lighter);
        }
        
        select {
            width: 100%;
            padding: 14px 16px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .strand-info {
            background: rgba(37, 99, 235, 0.1);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-lighter);
        }
        
        .strand-info.hidden {
            display: none;
        }

        /* Enhanced Chatbot Styles */
        .chatbot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .chatbot-toggle:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .chatbot-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 420px;
            height: 580px;
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
            transform: scale(0);
            transform-origin: bottom right;
            transition: transform 0.3s;
            max-height: calc(100vh - 150px);
            max-width: calc(100vw - 60px);
        }

        .chatbot-window.active {
            transform: scale(1);
        }

        .chatbot-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-header h3 {
            color: var(--text-lighter);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }

        .chatbot-close:hover {
            color: var(--text-light);
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 12px;
            line-height: 1.4;
        }

        .message.user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.bot {
            align-self: flex-start;
            background: rgba(26, 34, 53, 0.7);
            color: var(--text-light);
            border: 1px solid var(--border);
            border-bottom-left-radius: 4px;
        }

        .chatbot-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
        }

        .chatbot-input button {
            padding: 12px 16px;
        }

        .suggested-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .suggested-question {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-light);
            border: 1px solid var(--border);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggested-question:hover {
            background: rgba(37, 99, 235, 0.2);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-muted);
            font-style: italic;
        }

        .typing-dots {
            display: flex;
            gap: 2px;
        }

        .typing-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--text-muted);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-5px); opacity: 1; }
        }

        /* Peptide Analysis Section */
        .peptide-analysis {
            margin-top: 25px;
            padding: 20px;
            background: rgba(26, 34, 53, 0.7);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .peptide-analysis h4 {
            color: var(--text-lighter);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .peptide-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .peptide-stat {
            background: rgba(45, 55, 72, 0.5);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .peptide-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-light);
            margin-bottom: 5px;
        }

        .peptide-stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .amino-acid-composition {
            margin-top: 20px;
        }

        .amino-acid-composition h5 {
            color: var(--text-lighter);
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .amino-acid-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }

        .amino-acid-item {
            background: rgba(45, 55, 72, 0.5);
            padding: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
        }

        .amino-acid-name {
            font-weight: 600;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .amino-acid-count {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .chatbot-window {
                width: 90vw;
                right: 5vw;
            }
            
            .peptide-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .amino-acid-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-height: 700px) {
            .chatbot-window {
                height: 450px;
            }
        }
    </style>
</head>
<body>
    <!-- Network lines background - More visible -->
    <div class="network-background" id="network-background"></div>
    
    <div class="container">
        <header>
            <h1>GenefloAI Genetic Translator</h1>
            <p>Translate DNA sequences to mRNA and polypeptide chains using advanced algorithms</p>
        </header>
        
        <!-- Strand Selection Card -->
        <div class="card">
            <div class="strand-selection">
                <div class="strand-options">
                    <div class="strand-option">
                        <label for="strand-type"><i class="fas fa-dna"></i> Strand Type</label>
                        <select id="strand-type">
                            <option value="template">Template Strand</option>
                            <option value="coding">Coding Strand</option>
                        </select>
                    </div>
                    
                    <div class="strand-option">
                        <label for="strand-direction"><i class="fas fa-arrows-alt-h"></i> Direction</label>
                        <select id="strand-direction">
                            <option value="3to5">3' → 5'</option>
                            <option value="5to3">5' → 3'</option>
                        </select>
                    </div>
                </div>
                
                <div class="strand-info" id="template-info">
                    <strong>Template Strand:</strong> Serves as the template for mRNA synthesis during transcription. 
                    The mRNA sequence is complementary to the template strand.
                </div>
                
                <div class="strand-info hidden" id="coding-info">
                    <strong>Coding Strand:</strong> Has the same sequence as the mRNA (with T instead of U). 
                    Also called the sense strand or non-template strand.
                </div>
            </div>
        </div>
        
        <!-- Main Input Card -->
        <div class="card">
            <div class="input-section">
                <div class="input-header">
                    <label for="dna-sequence" id="sequence-label">
                        <i class="fas fa-dna"></i> Enter DNA Sequence:
                    </label>
                    <div class="sequence-counter">
                        <span id="base-count">0</span> bases
                    </div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="dna-sequence" placeholder="e.g., TACGAATTCTAGCATGAC">
                    <div class="input-actions">
                        <button id="translate-btn">
                            <i class="fas fa-code"></i> Translate
                        </button>
                        <button class="secondary" id="clear-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="results">
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-exchange-alt"></i> <span id="complementary-label">Coding Strand (5'→3')</span>
                    </div>
                    <div class="result-content" id="complementary-strand">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-rna"></i> mRNA Sequence (5'→3')
                    </div>
                    <div class="result-content" id="mrna-sequence">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-link"></i> Polypeptide Chain
                    </div>
                    <div class="result-content" id="polypeptide-chain">-</div>
                    <div class="molecular-weight" id="molecular-weight">Molecular Weight: -</div>
                </div>
            </div>

            <!-- Peptide Analysis Section -->
            <div class="peptide-analysis" id="peptide-analysis" style="display: none;">
                <h4><i class="fas fa-chart-bar"></i> Peptide Analysis</h4>
                
                <div class="peptide-stats">
                    <div class="peptide-stat">
                        <div class="peptide-stat-value" id="peptide-length">0</div>
                        <div class="peptide-stat-label">Amino Acids</div>
                    </div>
                    <div class="peptide-stat">
                        <div class="peptide-stat-value" id="peptide-weight">0</div>
                        <div class="peptide-stat-label">Molecular Weight (Da)</div>
                    </div>
                    <div class="peptide-stat">
                        <div class="peptide-stat-value" id="peptide-charge">0</div>
                        <div class="peptide-stat-label">Theoretical pI</div>
                    </div>
                    <div class="peptide-stat">
                        <div class="peptide-stat-value" id="peptide-hydrophobicity">0</div>
                        <div class="peptide-stat-label">Hydrophobicity Index</div>
                    </div>
                </div>

                <div class="amino-acid-composition">
                    <h5>Amino Acid Composition</h5>
                    <div class="amino-acid-grid" id="amino-acid-composition">
                        <!-- Amino acid composition will be populated here -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="visualization">
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-dna"></i>
                </div>
                <div class="step-label">DNA Template</div>
                <div class="dna-strand" id="dna-visualization">
                    <div class="placeholder">Enter sequence</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-rna"></i>
                </div>
                <div class="step-label">mRNA</div>
                <div class="dna-strand" id="mrna-visualization">
                    <div class="placeholder">Transcription</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-link"></i>
                </div>
                <div class="step-label">Protein</div>
                <div class="dna-strand" id="protein-visualization">
                    <div class="placeholder">Translation</div>
                </div>
                <div class="protein-info" id="protein-info">Peptide length: 0</div>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-card">
                <h3><i class="fas fa-dna"></i> Genetic Code</h3>
                <ul>
                    <li><span class="highlight">Adenine (A)</span> pairs with <span class="highlight">Thymine (T)</span> in DNA</li>
                    <li><span class="highlight">Guanine (G)</span> pairs with <span class="highlight">Cytosine (C)</span> in DNA</li>
                    <li>In RNA, <span class="highlight">Thymine (T)</span> is replaced with <span class="highlight">Uracil (U)</span></li>
                    <li><span class="start-codon">AUG</span> is the start codon (Methionine)</li>
                    <li><span class="stop-codon">UAA, UAG, UGA</span> are stop codons</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-flask"></i> Applications</h3>
                <ul>
                    <li>Genetic research and education</li>
                    <li>Protein synthesis simulation</li>
                    <li>Bioinformatics workflows</li>
                    <li>Molecular biology studies</li>
                    <li>AI-powered genetic analysis</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-weight"></i> Molecular Weight Calculation</h3>
                <ul>
                    <li>Calculated for the polypeptide chain</li>
                    <li>Accounts for water loss in peptide bonds</li>
                    <li>Based on standard amino acid molecular weights</li>
                    <li>Displayed in Daltons (Da)</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>GenefloAI Genetic Translator | Advanced DNA to Protein Conversion Tool</p>
            <p>© 2025 GenefloAI Research</p>
        </footer>
    </div>

    <!-- Enhanced Chatbot -->
    <div class="chatbot-container">
        <div class="chatbot-toggle" id="chatbot-toggle">
            <i class="fas fa-robot"></i>
        </div>
        <div class="chatbot-window" id="chatbot-window">
            <div class="chatbot-header">
                <h3><i class="fas fa-robot"></i> MolGenoBot</h3>
                <button class="chatbot-close" id="chatbot-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot">
                    Hello! I'm MolGenoBot, your molecular genetics assistant. I can help explain DNA structure, replication, transcription, translation, and more based on the latest research. What would you like to know?
                    <div class="suggested-questions">
                        <div class="suggested-question">DNA structure</div>
                        <div class="suggested-question">Transcription process</div>
                        <div class="suggested-question">Genetic code</div>
                        <div class="suggested-question">Lac operon</div>
                    </div>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Ask about molecular genetics...">
                <button id="chatbot-send"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Create network background with more visibility
        function createNetworkBackground() {
            const container = document.getElementById('network-background');
            const dots = [];
            const lines = [];
            
            // Create more dots for better visibility
            for (let i = 0; i < 60; i++) {
                const dot = document.createElement('div');
                dot.className = 'network-dot';
                dot.style.left = `${Math.random() * 100}%`;
                dot.style.top = `${Math.random() * 100}%`;
                container.appendChild(dot);
                dots.push(dot);
            }
            
            // Create lines between nearby dots
            for (let i = 0; i < dots.length; i++) {
                for (let j = i + 1; j < dots.length; j++) {
                    const dot1 = dots[i];
                    const dot2 = dots[j];
                    
                    const x1 = parseFloat(dot1.style.left);
                    const y1 = parseFloat(dot1.style.top);
                    const x2 = parseFloat(dot2.style.left);
                    const y2 = parseFloat(dot2.style.top);
                    
                    const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
                    
                    // Connect more dots for better visibility
                    if (distance < 25) {
                        const line = document.createElement('div');
                        line.className = 'network-line';
                        
                        const length = distance;
                        const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
                        
                        line.style.width = `${length}%`;
                        line.style.left = `${x1}%`;
                        line.style.top = `${y1}%`;
                        line.style.transform = `rotate(${angle}deg)`;
                        
                        container.appendChild(line);
                        lines.push(line);
                    }
                }
            }
        }

        // Enhanced MolGenoBot with Backend Integration
        function initializeChatbot() {
            const chatbotToggle = document.getElementById('chatbot-toggle');
            const chatbotWindow = document.getElementById('chatbot-window');
            const chatbotClose = document.getElementById('chatbot-close');
            const chatbotMessages = document.getElementById('chatbot-messages');
            const chatbotInput = document.getElementById('chatbot-input');
            const chatbotSend = document.getElementById('chatbot-send');
            
            // Backend API URL
            const BACKEND_URL = 'http://localhost:3000/api';
            
            // User session
            let userSession = {
                id: localStorage.getItem('user_id') || generateUserId(),
                knowledgeLevel: parseInt(localStorage.getItem('knowledge_level')) || 0,
                interests: JSON.parse(localStorage.getItem('user_interests')) || [],
                conversationHistory: JSON.parse(localStorage.getItem('conversation_history')) || []
            };
            
            // Toggle chatbot window
            chatbotToggle.addEventListener('click', () => {
                chatbotWindow.classList.toggle('active');
                if (chatbotWindow.classList.contains('active')) {
                    chatbotInput.focus();
                }
            });
            
            // Close chatbot window
            chatbotClose.addEventListener('click', () => {
                chatbotWindow.classList.remove('active');
            });
            
            // Send message
            async function sendMessage() {
                const message = chatbotInput.value.trim();
                if (!message) return;
                
                // Add user message
                addMessage(message, 'user');
                chatbotInput.value = '';
                
                // Show typing indicator
                showTypingIndicator();
                
                try {
                    // Send message to backend
                    const response = await fetch(`${BACKEND_URL}/chat`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            message: message,
                            userSession: userSession
                        })
                    });
                    
                    const data = await response.json();
                    
                    // Remove typing indicator
                    removeTypingIndicator();
                    
                    // Add bot response
                    addMessage(data.response, 'bot');
                    
                    // Update user session
                    if (data.updatedSession) {
                        userSession = { ...userSession, ...data.updatedSession };
                        saveUserSession();
                    }
                    
                } catch (error) {
                    removeTypingIndicator();
                    addMessage("I'm having trouble connecting right now. Let me provide a basic response.", 'bot');
                    // Fallback response
                    const fallbackResponse = generateFallbackResponse(message);
                    addMessage(fallbackResponse, 'bot');
                }
            }
            
            // Send message on button click
            chatbotSend.addEventListener('click', sendMessage);
            
            // Send message on Enter key
            chatbotInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Add message to chat
            function addMessage(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', sender);
                messageElement.innerHTML = text;
                chatbotMessages.appendChild(messageElement);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                
                // Save to conversation history
                if (sender === 'user' || sender === 'bot') {
                    userSession.conversationHistory.push({
                        sender: sender,
                        message: text,
                        timestamp: new Date().toISOString()
                    });
                    saveUserSession();
                }
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                const typingElement = document.createElement('div');
                typingElement.classList.add('message', 'bot', 'typing-indicator');
                typingElement.id = 'typing-indicator';
                typingElement.innerHTML = `
                    MolGenoBot is thinking
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                chatbotMessages.appendChild(typingElement);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }
            
            // Remove typing indicator
            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // Generate fallback response when backend is unavailable
            function generateFallbackResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                if (lowerMessage.includes('dna') && lowerMessage.includes('structure')) {
                    return "DNA has a double-helical structure with two antiparallel strands. The backbone is made of sugar-phosphate groups, and bases (A, T, C, G) project inward, forming complementary pairs (A-T, G-C).";
                } else if (lowerMessage.includes('transcription')) {
                    return "Transcription is the process where DNA is copied into mRNA. RNA polymerase binds to promoter regions and synthesizes mRNA complementary to the template strand.";
                } else if (lowerMessage.includes('translation')) {
                    return "Translation converts mRNA into proteins. Ribosomes read mRNA codons, and tRNA brings corresponding amino acids to build polypeptide chains.";
                } else if (lowerMessage.includes('genetic code')) {
                    return "The genetic code is the set of rules by which mRNA sequences are translated into proteins. It's triplet (3 bases per codon), degenerate (multiple codons per amino acid), and nearly universal.";
                } else {
                    return "I can help you understand molecular genetics concepts like DNA structure, replication, transcription, translation, and gene regulation. What specific topic interests you?";
                }
            }
            
            // Generate user ID
            function generateUserId() {
                const userId = 'user_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('user_id', userId);
                return userId;
            }
            
            // Save user session to localStorage
            function saveUserSession() {
                localStorage.setItem('knowledge_level', userSession.knowledgeLevel.toString());
                localStorage.setItem('user_interests', JSON.stringify(userSession.interests));
                localStorage.setItem('conversation_history', JSON.stringify(userSession.conversationHistory));
            }
            
            // Suggested questions
            document.querySelectorAll('.suggested-question').forEach(question => {
                question.addEventListener('click', () => {
                    chatbotInput.value = question.textContent;
                    sendMessage();
                });
            });
        }

        // DNA Translation Functionality with Peptide Calculation
        document.addEventListener('DOMContentLoaded', function() {
            createNetworkBackground();
            initializeChatbot();
            
            // DOM Elements
            const strandType = document.getElementById('strand-type');
            const strandDirection = document.getElementById('strand-direction');
            const templateInfo = document.getElementById('template-info');
            const codingInfo = document.getElementById('coding-info');
            const sequenceLabel = document.getElementById('sequence-label');
            const complementaryLabel = document.getElementById('complementary-label');
            
            const translateBtn = document.getElementById('translate-btn');
            const clearBtn = document.getElementById('clear-btn');
            const dnaInput = document.getElementById('dna-sequence');
            const complementaryStrand = document.getElementById('complementary-strand');
            const mRNA = document.getElementById('mrna-sequence');
            const polypeptide = document.getElementById('polypeptide-chain');
            const molecularWeight = document.getElementById('molecular-weight');
            const baseCount = document.getElementById('base-count');
            const notification = document.getElementById('notification');
            const proteinInfo = document.getElementById('protein-info');
            const peptideAnalysis = document.getElementById('peptide-analysis');
            
            // Genetic code mapping
            const geneticCode = {
                "UUU": "Phe", "UUC": "Phe", "UUA": "Leu", "UUG": "Leu",
                "CUU": "Leu", "CUC": "Leu", "CUA": "Leu", "CUG": "Leu",
                "AUU": "Ile", "AUC": "Ile", "AUA": "Ile", "AUG": "Met",
                "GUU": "Val", "GUC": "Val", "GUA": "Val", "GUG": "Val",
                "UCU": "Ser", "UCC": "Ser", "UCA": "Ser", "UCG": "Ser",
                "CCU": "Pro", "CCC": "Pro", "CCA": "Pro", "CCG": "Pro",
                "ACU": "Thr", "ACC": "Thr", "ACA": "Thr", "ACG": "Thr",
                "GCU": "Ala", "GCC": "Ala", "GCA": "Ala", "GCG": "Ala",
                "UAU": "Tyr", "UAC": "Tyr", "UAA": "STOP", "UAG": "STOP",
                "CAU": "His", "CAC": "His", "CAA": "Gln", "CAG": "Gln",
                "AAU": "Asn", "AAC": "Asn", "AAA": "Lys", "AAG": "Lys",
                "GAU": "Asp", "GAC": "Asp", "GAA": "Glu", "GAG": "Glu",
                "UGU": "Cys", "UGC": "Cys", "UGA": "STOP", "UGG": "Trp",
                "CGU": "Arg", "CGC": "Arg", "CGA": "Arg", "CGG": "Arg",
                "AGU": "Ser", "AGC": "Ser", "AGA": "Arg", "AGG": "Arg",
                "GGU": "Gly", "GGC": "Gly", "GGA": "Gly", "GGG": "Gly"
            };
            
            // Amino acid molecular weights (in Daltons)
            const aminoAcidWeights = {
                "Ala": 89.09, "Arg": 174.20, "Asn": 132.12, "Asp": 133.10,
                "Cys": 121.16, "Gln": 146.15, "Glu": 147.13, "Gly": 75.07,
                "His": 155.16, "Ile": 131.17, "Leu": 131.17, "Lys": 146.19,
                "Met": 149.21, "Phe": 165.19, "Pro": 115.13, "Ser": 105.09,
                "Thr": 119.12, "Trp": 204.23, "Tyr": 181.19, "Val": 117.15
            };
            
            // Amino acid properties for peptide analysis
            const aminoAcidProperties = {
                "Ala": { pKa: 2.34, pKb: 9.69, hydrophobicity: 1.8 },
                "Arg": { pKa: 2.17, pKb: 9.04, hydrophobicity: -4.5 },
                "Asn": { pKa: 2.02, pKb: 8.80, hydrophobicity: -3.5 },
                "Asp": { pKa: 1.88, pKb: 9.60, hydrophobicity: -3.5 },
                "Cys": { pKa: 1.96, pKb: 10.28, hydrophobicity: 2.5 },
                "Gln": { pKa: 2.17, pKb: 9.13, hydrophobicity: -3.5 },
                "Glu": { pKa: 2.19, pKb: 9.67, hydrophobicity: -3.5 },
                "Gly": { pKa: 2.34, pKb: 9.60, hydrophobicity: -0.4 },
                "His": { pKa: 1.82, pKb: 9.17, hydrophobicity: -3.2 },
                "Ile": { pKa: 2.36, pKb: 9.68, hydrophobicity: 4.5 },
                "Leu": { pKa: 2.36, pKb: 9.60, hydrophobicity: 3.8 },
                "Lys": { pKa: 2.18, pKb: 8.95, hydrophobicity: -3.9 },
                "Met": { pKa: 2.28, pKb: 9.21, hydrophobicity: 1.9 },
                "Phe": { pKa: 1.83, pKb: 9.13, hydrophobicity: 2.8 },
                "Pro": { pKa: 1.99, pKb: 10.60, hydrophobicity: -1.6 },
                "Ser": { pKa: 2.21, pKb: 9.15, hydrophobicity: -0.8 },
                "Thr": { pKa: 2.11, pKb: 9.62, hydrophobicity: -0.7 },
                "Trp": { pKa: 2.38, pKb: 9.39, hydrophobicity: -0.9 },
                "Tyr": { pKa: 2.20, pKb: 9.11, hydrophobicity: -1.3 },
                "Val": { pKa: 2.32, pKb: 9.62, hydrophobicity: 4.2 }
            };
            
            // Update strand info display
            function updateStrandInfo() {
                if (strandType.value === 'template') {
                    templateInfo.classList.remove('hidden');
                    codingInfo.classList.add('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Template Strand:';
                    complementaryLabel.textContent = 'Coding Strand (5\'→3\')';
                } else {
                    templateInfo.classList.add('hidden');
                    codingInfo.classList.remove('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Coding Strand:';
                    complementaryLabel.textContent = 'Template Strand (3\'→5\')';
                }
            }
            
            // Show notification
            function showNotification(message, type = 'success') {
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // Function to get complementary DNA strand
            function getComplementaryStrand(sequence) {
                const complementMap = { 'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => complementMap[base]).join('');
            }
            
            // Function to reverse a sequence
            function reverseSequence(sequence) {
                return sequence.split('').reverse().join('');
            }
            
            // Function to transcribe DNA to mRNA
            function transcribeToMRNA(sequence) {
                const transcriptionMap = { 'A': 'U', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => transcriptionMap[base]).join('');
            }
            
            // Function to translate mRNA to polypeptide
            function translateToPolypeptide(mRNA) {
                let polypeptide = [];
                
                // Split mRNA into codons (groups of 3 nucleotides)
                for (let i = 0; i < mRNA.length; i += 3) {
                    const codon = mRNA.substring(i, i + 3);
                    
                    // Stop translation if we encounter a stop codon
                    if (codon.length < 3) break;
                    
                    const aminoAcid = geneticCode[codon];
                    if (aminoAcid === "STOP") {
                        polypeptide.push("STOP");
                        break;
                    }
                    
                    polypeptide.push(aminoAcid);
                }
                
                return polypeptide;
            }
            
            // Function to calculate molecular weight of polypeptide
            function calculateMolecularWeight(aminoAcids) {
                // Remove STOP codon if present
                const filteredAminoAcids = aminoAcids.filter(aa => aa !== "STOP");
                
                if (filteredAminoAcids.length === 0) return 0;
                
                // Calculate total weight of amino acids
                let totalWeight = 0;
                for (const aa of filteredAminoAcids) {
                    totalWeight += aminoAcidWeights[aa];
                }
                
                // Subtract water loss from peptide bond formation (18.015 Da per bond)
                // Number of bonds = number of amino acids - 1
                const waterLoss = 18.015 * (filteredAminoAcids.length - 1);
                
                return totalWeight - waterLoss;
            }
            
            // Function to analyze peptide properties
            function analyzePeptide(aminoAcids) {
                // Remove STOP codon if present
                const filteredAminoAcids = aminoAcids.filter(aa => aa !== "STOP");
                
                if (filteredAminoAcids.length === 0) {
                    return {
                        length: 0,
                        weight: 0,
                        pI: 0,
                        hydrophobicity: 0,
                        composition: {}
                    };
                }
                
                // Calculate amino acid composition
                const composition = {};
                filteredAminoAcids.forEach(aa => {
                    composition[aa] = (composition[aa] || 0) + 1;
                });
                
                // Calculate theoretical pI (isoelectric point)
                const pI = calculateTheoreticalPI(filteredAminoAcids);
                
                // Calculate average hydrophobicity
                const hydrophobicity = calculateHydrophobicity(filteredAminoAcids);
                
                return {
                    length: filteredAminoAcids.length,
                    weight: calculateMolecularWeight(aminoAcids),
                    pI: pI,
                    hydrophobicity: hydrophobicity,
                    composition: composition
                };
            }
            
            // Function to calculate theoretical pI
            function calculateTheoreticalPI(aminoAcids) {
                // Simplified pI calculation based on amino acid properties
                let acidicCount = 0;
                let basicCount = 0;
                
                aminoAcids.forEach(aa => {
                    if (['Asp', 'Glu'].includes(aa)) acidicCount++;
                    if (['Lys', 'Arg', 'His'].includes(aa)) basicCount++;
                });
                
                // Simple approximation
                const netCharge = basicCount - acidicCount;
                return 6.5 + (netCharge * 0.1); // Base pI with adjustment for charge
            }
            
            // Function to calculate hydrophobicity
            function calculateHydrophobicity(aminoAcids) {
                let totalHydrophobicity = 0;
                aminoAcids.forEach(aa => {
                    totalHydrophobicity += aminoAcidProperties[aa]?.hydrophobicity || 0;
                });
                return totalHydrophobicity / aminoAcids.length;
            }
            
            // Function to update peptide analysis display
            function updatePeptideAnalysis(analysis) {
                const peptideLength = document.getElementById('peptide-length');
                const peptideWeight = document.getElementById('peptide-weight');
                const peptideCharge = document.getElementById('peptide-charge');
                const peptideHydrophobicity = document.getElementById('peptide-hydrophobicity');
                const aminoAcidComposition = document.getElementById('amino-acid-composition');
                
                peptideLength.textContent = analysis.length;
                peptideWeight.textContent = analysis.weight.toFixed(2);
                peptideCharge.textContent = analysis.pI.toFixed(2);
                peptideHydrophobicity.textContent = analysis.hydrophobicity.toFixed(2);
                
                // Update amino acid composition
                aminoAcidComposition.innerHTML = '';
                Object.entries(analysis.composition)
                    .sort((a, b) => b[1] - a[1])
                    .forEach(([aa, count]) => {
                        const aaItem = document.createElement('div');
                        aaItem.className = 'amino-acid-item';
                        aaItem.innerHTML = `
                            <span class="amino-acid-name">${aa}</span>
                            <span class="amino-acid-count">${count}</span>
                        `;
                        aminoAcidComposition.appendChild(aaItem);
                    });
                
                // Show peptide analysis section
                peptideAnalysis.style.display = 'block';
            }
            
            // Update visualization
            function updateVisualization(seq, proteinArray) {
                const dnaVisualization = document.getElementById('dna-visualization');
                const mRNAVisualization = document.getElementById('mrna-visualization');
                const proteinVisualization = document.getElementById('protein-visualization');
                
                // Clear previous visualization
                dnaVisualization.innerHTML = '';
                mRNAVisualization.innerHTML = '';
                proteinVisualization.innerHTML = '';
                
                if (!seq) {
                    // Add placeholders if no sequence
                    dnaVisualization.innerHTML = '<div class="placeholder">Enter sequence</div>';
                    mRNAVisualization.innerHTML = '<div class="placeholder">Transcription</div>';
                    proteinVisualization.innerHTML = '<div class="placeholder">Translation</div>';
                    proteinInfo.textContent = 'Peptide length: 0';
                    peptideAnalysis.style.display = 'none';
                    return;
                }
                
                // Create DNA visualization (max 4 bases for display on mobile)
                const displaySeq = seq.substring(0, window.innerWidth < 768 ? 4 : 6);
                for (let i = 0; i < displaySeq.length; i++) {
                    const base = displaySeq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    dnaVisualization.appendChild(baseEl);
                    
                    if (i < displaySeq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        dnaVisualization.appendChild(bond);
                    }
                }
                
                // Create mRNA visualization
                const mRNAseq = transcribeToMRNA(displaySeq);
                
                for (let i = 0; i < mRNAseq.length; i++) {
                    const base = mRNAseq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    mRNAVisualization.appendChild(baseEl);
                    
                    if (i < mRNAseq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        mRNAVisualization.appendChild(bond);
                    }
                }
                
                // Create protein visualization (first 2-3 amino acids)
                const displayProteinCount = window.innerWidth < 768 ? 2 : 3;
                for (let i = 0; i < Math.min(displayProteinCount, proteinArray.length); i++) {
                    const aa = proteinArray[i];
                    const aaEl = document.createElement('div');
                    aaEl.className = 'base';
                    
                    if (aa === "STOP") {
                        aaEl.classList.add('stop-codon');
                        aaEl.textContent = "STP";
                    } else if (aa === "Met" && i === 0) {
                        aaEl.classList.add('start-codon');
                        aaEl.textContent = aa.substring(0, 3);
                    } else {
                        aaEl.textContent = aa.substring(0, 3);
                    }
                    
                    proteinVisualization.appendChild(aaEl);
                    
                    if (i < Math.min(displayProteinCount, proteinArray.length) - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        proteinVisualization.appendChild(bond);
                    }
                }
                
                // Update protein info
                const peptideLength = proteinArray.filter(aa => aa !== "STOP").length;
                proteinInfo.textContent = `Peptide length: ${peptideLength}`;
            }
            
            // Update base counter
            function updateBaseCounter(sequence) {
                baseCount.textContent = sequence.length;
            }
            
            // Event listeners for strand selection
            strandType.addEventListener('change', updateStrandInfo);
            strandDirection.addEventListener('change', function() {
                // Clear results when direction changes
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateVisualization(null, []);
                peptideAnalysis.style.display = 'none';
            });
            
            // Initialize strand info
            updateStrandInfo();
            
            // Event listener for real-time input
            dnaInput.addEventListener('input', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Only allow valid DNA characters
                if (!/^[ATCG]*$/.test(dnaSequence)) {
                    // Remove invalid characters
                    dnaInput.value = dnaSequence.replace(/[^ATCG]/gi, '');
                }
                
                // Update base counter
                updateBaseCounter(dnaInput.value);
            });
            
            // Clear button functionality
            clearBtn.addEventListener('click', function() {
                dnaInput.value = '';
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateBaseCounter('');
                updateVisualization(null, []);
                peptideAnalysis.style.display = 'none';
                showNotification('Cleared all data');
            });
            
            translateBtn.addEventListener('click', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Show loading state
                const originalText = translateBtn.innerHTML;
                translateBtn.innerHTML = '<div class="loading"></div> Translating...';
                translateBtn.disabled = true;
                
                // Reset previous results
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                peptideAnalysis.style.display = 'none';
                
                // Validate input
                if (!dnaSequence) {
                    showNotification('Please enter a DNA sequence.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                if (!/^[ATCG]+$/.test(dnaSequence)) {
                    showNotification('DNA sequence can only contain A, T, C, or G.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                // Simulate processing delay for better UX
                setTimeout(() => {
                    let templateStrand, codingStrand, mRNAseq;
                    
                    // Process based on selected strand type and direction
                    if (strandType.value === 'template') {
                        // User entered template strand
                        if (strandDirection.value === '3to5') {
                            // Template strand is 3'→5', which is the standard
                            templateStrand = dnaSequence;
                            codingStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Template strand is 5'→3', need to reverse
                            templateStrand = reverseSequence(dnaSequence);
                            codingStrand = getComplementaryStrand(templateStrand);
                        }
                    } else {
                        // User entered coding strand
                        if (strandDirection.value === '5to3') {
                            // Coding strand is 5'→3', which is the standard
                            codingStrand = dnaSequence;
                            templateStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Coding strand is 3'→5', need to reverse
                            codingStrand = reverseSequence(dnaSequence);
                            templateStrand = getComplementaryStrand(codingStrand);
                        }
                    }
                    
                    // Transcribe to mRNA (5' to 3') using template strand
                    mRNAseq = transcribeToMRNA(templateStrand);
                    
                    // Translate to polypeptide chain
                    const proteinArray = translateToPolypeptide(mRNAseq);
                    const proteinString = proteinArray.join('-');
                    
                    // Calculate molecular weight
                    const weight = calculateMolecularWeight(proteinArray);
                    
                    // Perform peptide analysis
                    const peptideAnalysisResult = analyzePeptide(proteinArray);
                    
                    // Update results
                    complementaryStrand.textContent = strandType.value === 'template' ? codingStrand : templateStrand;
                    mRNA.textContent = mRNAseq;
                    polypeptide.textContent = proteinString;
                    molecularWeight.textContent = `Molecular Weight: ${weight.toFixed(2)} Da`;
                    
                    // Update visualization
                    updateVisualization(dnaSequence, proteinArray);
                    
                    // Update peptide analysis
                    updatePeptideAnalysis(peptideAnalysisResult);
                    
                    // Reset button
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    
                    showNotification('Translation completed successfully!');
                }, 800);
            });
            
            // Initialize with empty visualization
            updateVisualization(null, []);
        });
    </script>
</body>
</html>
